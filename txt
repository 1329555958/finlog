var map={},hits=payload.hits.hits; for(vari=0;i<hits.length;i++){ varsource=hits[i]._source; if(!map[source.partner_id]){ map[source.partner_id]={}; } varpartner=map[source.partner_id]; if(!partner[source.interface_type]){ partner[source.interface_type]=[]; } varrequest={}; request[source.request_time]=source.consuming_time; partner[source.interface_type].push(request); } varresult=[]; for(varid,partnerinmap){ result.push('<h1>'); result.push('商户号:'+id); result.push('</h1>') for(varname,infinpartner){ result.push('<h3>'); result.push('接口名:'+name); result.push('</h3>'); for(vari=0;i<inf.length;i++){ for(vark,vininf[i]){ result.push('<p>'+k+":"+v+'</p>'); } } } } payload.format=result.join();